{
    "collab_server" : "",
    "contents" : "library(iNEXT)\nlibrary(ggplot2)\nlibrary(grid)\nlibrary(gridExtra)\n\npng(\"Output/BW Rarefaction All.png\", width=1300, height=600)\nggiNEXT(bw_sample.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\n\npng(\"Output/BW Rarefaction Ants.png\", width=1300, height=600)\nggiNEXT(bw_sample.ants.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\n\npng(\"Output/BW Rarefaction Coleoptera.png\", width=1300, height=600)\nggiNEXT(bw_sample.coleoptera.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\n\npng(\"Output/BW Rarefaction Hemiptera.png\", width=1300, height=600)\nggiNEXT(bw_sample.hemiptera.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\n\n\npng(\"Output/BW_VS Rarefaction ALL.png\", width=1300, height=600)\nggiNEXT(bw_vs_site_host.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\n\n\nplotExpectedDiversity <- function(data.iNEXT, cut.point, title = NULL, sub = NULL, q = c(0,1,2), sort = NULL, legend = T, ylim = NULL) {\n  rare10 <- do.call(\"rbind\", lapply(data.iNEXT$Accumulation, function(x) { unique(x[x$t == cut.point, ]) }))\n  \n  order0 <- order(subset(rare10, order==0)$qD)\n  if (!missing(sort))\n    order0 <- match(sort, names(data.iNEXT$Accumulation))\n  \n  .par.mar <- par(\"mar\")\n  .par.oma <- par(\"oma\")\n  \n  xx=1:length(order0)\n  #quartz(height=8, width=8)\n  numcells <- max(q) + 1\n  if (legend)\n    numcells <- numcells + 1\n  if (numcells > 1) {\n    par(mfrow=c(ceiling(numcells / 2),ceiling(numcells / 2)))\n    par(mar=c(5,4,1,1))\n    if (missing(title))\n      par(oma=c(6,4,1,1))\n    else\n      par(oma=c(6,4,4,1))\n  }\n  i <- 1\n  for (i in (q + 1)){\n    if (numcells > 1)\n      if (i==1) par(mar=c(1,4,5,1)) else par(mar=c(5,4,1,1))\n    tmp <- subset(rare10, order==(i-1))[order0,]\n    if (missing(ylim))\n      tmpylim <- c(floor(min(tmp$qD.95.LCL) / 10) * 10, ceiling(max(tmp$qD.95.UCL) / 10) * 10)\n    else\n      tmpylim <- ylim\n    plot(xx, tmp$qD.95.UCL, xlab=\"\", ylab=\"\", axes=F, type=\"n\", ylim=tmpylim)\n    with(tmp, arrows(xx, qD.95.LCL, xx, qD.95.UCL, code=3, length=.03, angle=90) )\n    with(tmp, points(xx, qD, pch=c(19,5,4)[factor(tmp$method, levels = c(\"interpolated\", \"observed\", \"extrapolated\"))]))\n    if (i!=1 || length(q) == 1) axis(1, las=2, at=xx, labels=paste(names(data.iNEXT$Accumulation)[order0]))\n    axis(2,las=2, cex.axis=1.3)\n    box(bty=\"L\", lwd=1.6)\n    subTitle <- paste0(\"q=\",(i-1))\n    if (!missing(sub))\n      subTitle <- paste(sub, subTitle, sep = \" \")\n    mtext(side=3, font=2, subTitle, line=-1)\n    if (i==1 && legend) {\n      plot(1,1, xlab=\"\", ylab=\"\", axes=F, type=\"n\")\n      legend(\"top\", pch = c(19,5,4), legend=c(\"Rarefied\", \"Observed\", \"Extrapolated\"), bty=\"n\", \n             title = paste(\"For sample count =\", cut.point), cex=1.3,inset=c(0,.15))\n    }\n  }\n  if (numcells > 1)\n    mtext(outer=TRUE, \"Site\", side=1, cex=1.4, line=1.25)\n  mtext(outer=TRUE, expression(paste(\"Expected diversity (\" ^plain(\"q\"), plain(\"D)\"))), side=2, cex=1.4, line=-1, las=0)\n  if (!missing(title))\n    mtext(outer = TRUE, title, side = 3, cex=1.4, line=1.25)\n  \n  if (numcells > 1)\n    par(mar = .par.mar, oma = .par.oma)\n  \n  names(data.iNEXT$Accumulation)[order0]\n}\n\npdf(\"Output/BW_VS Site Host Expected Diversity (n=10).pdf\", width = 8, height = 8, useDingbats = F)\nplotExpectedDiversity(bw_vs_site_host.iNEXT.10, 10)\ndev.off()\npdf(\"Output/BW_VS Site Host Expected Diversity (n=15).pdf\", width = 8, height = 8, useDingbats = F)\nplotExpectedDiversity(bw_vs_site_host.iNEXT.15, 15)\ndev.off()\npdf(\"Output/BW_VS Site Host Expected Diversity (n=20).pdf\", width = 8, height = 8, useDingbats = F)\nplotExpectedDiversity(bw_vs_site_host.iNEXT.20, 20)\ndev.off()\n\nggiNEXT(bw_vs_site_host.iNEXT.enoughtrees.summer, type = \"1\", facet.var = \"order\")\nggiNEXT(bw_vs_site_host.iNEXT.enoughtrees.spring, type = \"1\", facet.var = \"order\")\nggiNEXT(bw_vs_site_host.iNEXT.enoughtrees.winter, type = \"1\", facet.var = \"order\")\npdf(\"Output/BW_VS Site Host Season Expected Diversity (n=7).pdf\", width = 8, height = 8, useDingbats = F)\nplotExpectedDiversity(bw_vs_site_host.iNEXT.enoughtrees.summer.7, 7, \"Summer\")\nplotExpectedDiversity(bw_vs_site_host.iNEXT.enoughtrees.spring.7, 7, \"Spring\")\nplotExpectedDiversity(bw_vs_site_host.iNEXT.enoughtrees.winter.7, 7, \"Winter\")\ndev.off()\n\npdf(\"Output/BW_VS Site Host Season Expected Richness q=0.pdf\", width = 8, height = 8, useDingbats = F)\n.pardefault <- par(no.readonly = T)\npar(mfrow=c(2,2))\npar(oma=c(6,4,1,1))\n#par(mar=c(1,4,5,1))\nbw_vs_site_host.iNEXT.10.sort <- plotExpectedDiversity(bw_vs_site_host.iNEXT.10, 10, ylim = c(10, 120), q = 0, sub = \"Overall\", legend = F)\n#par(mar=c(5,4,1,1))\nplotExpectedDiversity(bw_vs_site_host.iNEXT.enoughtrees.spring.7, 7, q = 0, sub = \"Spring\", sort = bw_vs_site_host.iNEXT.10.sort, legend = F, ylim = c(10, 120))\nplotExpectedDiversity(bw_vs_site_host.iNEXT.enoughtrees.summer.7, 7, q = 0, sub = \"Summer\", sort = bw_vs_site_host.iNEXT.10.sort, legend = F, ylim = c(10, 120))\nplotExpectedDiversity(bw_vs_site_host.iNEXT.enoughtrees.winter.7, 7, q = 0, sub = \"Winter\", sort = bw_vs_site_host.iNEXT.10.sort, legend = F, ylim = c(10, 120))\npar(.pardefault)\ndev.off()\n\n\npdf(\"Output/BW_VS Rarefaction By Host.pdf\", width = 20, height = 7, useDingbats = F)\nggiNEXT(bw_vs_host.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\npdf(\"Output/BW_VS Rarefaction By Host Region.pdf\", width = 20, height = 7, useDingbats = F)\nggiNEXT(bw_vs_region_host.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\nggiNEXT(bw_vs_region_host.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18) + xlim(0, 150)\ndev.off()\npdf(\"Output/BW_VS Rarefaction By Host Region MP3_4 KZN2_3.pdf\", width = 20, height = 7, useDingbats = F)\nggiNEXT(bw_vs_region_host.MP34KZN23.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\npdf(\"Output/BW_VS Rarefaction By Host Region Summer.pdf\", width = 20, height = 7, useDingbats = F)\nggiNEXT(bw_vs_region_host.summer.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\npdf(\"Output/BW_VS Rarefaction By Host Region Winter.pdf\", width = 20, height = 7, useDingbats = F)\nggiNEXT(bw_vs_region_host.winter.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\npdf(\"Output/BW_VS Rarefaction By Host Region Spring.pdf\", width = 20, height = 7, useDingbats = F)\nggiNEXT(bw_vs_region_host.spring.iNEXT, type=1, facet.var=\"order\") + labs(x=\"Number of trees\") + theme_bw(base_size = 18)\ndev.off()\n\nhost_season_taxa.iNEXT.palette <- scale_colour_manual(\"Order\", values = c(\n  \"MP1\" = \"#F1A340\", \"MP2\" = \"#F1A340\", \"MP3\" = \"#F1A340\",\n  \"MP4\" = \"#F1A340\", \"MP5\" = \"#F1A340\", \"MP6\" = \"#F1A340\",\n  \"MP7\" = \"#F1A340\", \"KZN1\" = \"#998EC3\", \"KZN2\" = \"#998EC3\",\n  \"KZN3\" = \"#998EC3\", \"KZN4\" = \"#998EC3\", \"KZN5\" = \"#998EC3\",\n  \"KZN6\" = \"#998EC3\", \"KZN7\" = \"#998EC3\"\n))\npdf(\"Output/BW Rarefaction Season Taxa.pdf\", width = 20, height = 14, useDingbats = F)\ngrid.arrange(\n  ncol = 3,\n  top = \"A_mearnsii\",\n  ggiNEXT(host_season_taxa.iNEXT$bw_ants_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"Formicidae\", title = \"Summer\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$bw_ants_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Spring\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  #ggiNEXT(host_season_taxa.iNEXT$bw_ants_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Winter\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  grob(),\n  ggiNEXT(host_season_taxa.iNEXT$bw_coleoptera_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"Coleoptera\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$bw_coleoptera_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$bw_coleoptera_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Winter\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$bw_hemiptera_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"Hemiptera\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$bw_hemiptera_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"Number of trees\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$bw_hemiptera_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  layout_matrix = rbind(c(1, 2, 3), c(4, 5, 6), c(7, 8, 9))\n)\ndev.off()\npdf(\"Output/VS Rarefaction Season Taxa.pdf\", width = 20, height = 14, useDingbats = F)\ngrid.arrange(\n  ncol = 3,\n  top = \"A_sieberiana\",\n  ggiNEXT(host_season_taxa.iNEXT$vs_ants_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"Formicidae\", title = \"Summer\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_ants_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Spring\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_ants_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Winter\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_coleoptera_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"Coleoptera\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_coleoptera_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_coleoptera_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_hemiptera_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"Hemiptera\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_hemiptera_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"Number of trees\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season_taxa.iNEXT$vs_hemiptera_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette\n)\ndev.off()\npdf(\"Output/BW_VS Rarefaction Season.pdf\", width = 20, height = 10, useDingbats = F)\ngrid.arrange(\n  ncol = 3,\n  top = \"A_mearnsii and A_sieberiana\",\n  ggiNEXT(host_season.iNEXT$bw_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"A_mearnsii\", title = \"Summer\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season.iNEXT$bw_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Spring\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season.iNEXT$bw_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\", title = \"Winter\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season.iNEXT$vs_summer, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"A_sieberiana\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season.iNEXT$vs_spring, type=1, facet.var=\"order\", se = F) + labs(x=\"Number of trees\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette,\n  ggiNEXT(host_season.iNEXT$vs_winter, type=1, facet.var=\"order\", se = F) + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + host_season_taxa.iNEXT.palette\n)\ndev.off()\n\npdf(\"Output/BW_VS Rarefaction Region Season.pdf\", width = 20, height = 10, useDingbats = F)\ngrid.arrange(\n  ncol = 3,\n  top = \"Region, Season\",\n  left = \"Morphospecies richness\",\n  ggiNEXT(region_season.iNEXT$KZN_summer, type=1, facet.var=\"order\") + labs(x=\"\", y = \"KZN\", title = \"Summer\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(region_season.iNEXT$KZN_spring, type=1, facet.var=\"order\") + labs(x=\"\", y = \"\", title = \"Spring\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(region_season.iNEXT$KZN_winter, type=1, facet.var=\"order\") + labs(x=\"\", y = \"\", title = \"Winter\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(region_season.iNEXT$MP_summer, type=1, facet.var=\"order\") + labs(x=\"\", y = \"MP\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(region_season.iNEXT$MP_spring, type=1, facet.var=\"order\") + labs(x=\"Number of trees\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(region_season.iNEXT$MP_winter, type=1, facet.var=\"order\") + labs(x=\"\", y = \"\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200)\n)\ndev.off()\n\npdf(\"Output/BW Rarefaction Season Region.pdf\", width = 20, height = 5, useDingbats = F)\ngrid.arrange(\n  ncol = 3,\n  top = \"Season, Region\",\n  left = \"Morphospecies richness\",\n  ggiNEXT(bw_season_region.iNEXT$Summer, type=1, facet.var=\"order\") + labs(x=\"\", y = \"\", title = \"Summer\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(bw_season_region.iNEXT$Spring, type=1, facet.var=\"order\") + labs(x=\"\", y = \"\", title = \"Spring\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200),\n  ggiNEXT(bw_season_region.iNEXT$Winter, type=1, facet.var=\"order\") + labs(x=\"\", y = \"\", title = \"Winter\") + theme_bw(base_size = 18) + guides(linetype = FALSE) + expand_limits(x = 100, y = 200)\n)\ndev.off()\n\n#ggiNEXT(bw_vs.bytree.iNEXT, type=1, facet.var=\"order\")\n",
    "created" : 1547923998290.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2751427054",
    "id" : "742062EE",
    "lastKnownWriteTime" : 1457979205,
    "last_content_update" : 1457979205,
    "path" : "~/Desktop/Acacia data/Acacia.iNEXT.rarefaction.R",
    "project_path" : "Acacia.iNEXT.rarefaction.R",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}